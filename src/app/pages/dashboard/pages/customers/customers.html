<div class="page-header">
  <div>
    <h1 class="page-title">Clientes</h1>
    <p class="page-subtitle">Gerencie os clientes cadastrados no sistema</p>
  </div>
  <button class="btn-primary-gradient" (click)="newCustomer()" data-bs-toggle="modal" data-bs-target="#novoClienteModal">
    <i class="bi bi-plus-lg"></i>
    Novo Cliente
  </button>
</div>

<!-- Search Card -->
<div class="dashboard-card mb-4">
  <div class="dashboard-card-body p-3">
    <div class="search-wrapper">
      <i class="bi bi-search search-icon"></i>
      <input
        type="text"
        class="form-control search-input"
        placeholder="Buscar por nome, CPF ou e-mail..."
      >
    </div>
  </div>
</div>

<!-- Clients Table Card -->
<div class="dashboard-card">
  <div class="dashboard-card-header">
    <h2 class="dashboard-card-title">Lista de Clientes</h2>
    <p class="dashboard-card-subtitle">
      {{ customers.length }} cliente(s) encontrado(s)
    </p>
  </div>
  <div class="table-responsive">
    <table class="table table-custom">
      <thead>
        <tr>
          <th>Cliente</th>
          <th>CPF</th>
          <th>Telefone</th>
          <th class="text-center">Compras</th>
          <th class="text-end">Cashback Ativo</th>
          <th class="text-center">Status</th>
          <th class="text-end">Ações</th>
        </tr>
      </thead>
      <tbody>
        @for (customer of customers; track customer.cpf) {
          <tr>
            <td>
              <div class="d-flex align-items-center gap-3">
                <div class="client-avatar">{{ getInitials(customer.name) }}</div>
                <div class="client-info">
                  <p class="client-name">{{ customer.name }}</p>
                  <p class="client-email">{{ customer.email }}</p>
                </div>
              </div>
            </td>
            <td class="text-muted">{{ customer.cpf }}</td>
            <td class="text-muted">{{ customer.phone }}</td>
            <td class="text-center fw-medium">{{ customer.totalPurchases }}</td>
            <td class="text-end cashback-value">R$ {{ customer.totalActiveCashback | number:'1.2-2' }}</td>
            <td class="text-center">
            <span class="badge-status" [ngClass]="customer.status === 'active' ? 'badge-active' : 'badge-inactive'">
              {{ customer.status }}
            </span>
            </td>
            <td class="text-end">
              <div class="dropdown">
                <button class="actions-btn" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                  <i class="bi bi-three-dots"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li>
                    <a class="dropdown-item" href="#"><i class="bi bi-eye me-2"></i> Ver detalhes</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="bi bi-gift me-2"></i> Ver cashbacks</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="bi bi-pencil me-2"></i> Editar</a>
                  </li>
                  <li>
                    <hr class="dropdown-divider">
                  </li>
                  <li>
                    <a class="dropdown-item text-danger" href="#"><i class="bi bi-trash me-2"></i> Excluir</a>
                  </li>
                </ul>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>

<!-- Modal Novo Cliente (Simplified structure based on reference) -->
<div class="modal fade" id="novoClienteModal" tabindex="-1" aria-labelledby="novoClienteModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="novoClienteModalLabel">Cadastrar Cliente</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>
      <form>
        <div class="modal-body">
          <p class="text-muted mb-4" style="font-size: 0.875rem;">
            Preencha os dados para cadastrar um novo cliente
          </p>

          <div class="mb-3">
            <label class="form-label-custom">Nome completo</label>
            <input type="text" class="form-control form-control-custom" placeholder="Nome do cliente" required>
          </div>

          <div class="row mb-3">
            <div class="col-6">
              <label class="form-label-custom">CPF</label>
              <input type="text" class="form-control form-control-custom" placeholder="000.000.000-00" required>
            </div>
            <div class="col-6">
              <label class="form-label-custom">Telefone</label>
              <input type="text" class="form-control form-control-custom" placeholder="(00) 00000-0000" required>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label-custom">E-mail</label>
            <input type="email" class="form-control form-control-custom" placeholder="email@exemplo.com">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn-primary-gradient">Cadastrar</button>
        </div>
      </form>
    </div>
  </div>
</div>
